#!/bin/bash
#remove SIZE element from a METS file generated by DAITSS Prep

#set input/output files
original_file="$1"
backup_file="${1}.backup"

#ensure file is readable and not zero length or dir
if [ ! -r "$original_file" ]; then
	echo "Access denied to file: $original_file"
	exit 1

	elif [ ! -s "$original_file" ]; then
		echo "File: $original_file either does not exist, or has zero length."
		exit 1

	elif [ -d "$original_file" ]; then
		echo "File: $original_file is actually a directory. Please specify another."
		exit 1
fi


mv $original_file $backup_file

#read input into awk to strip out size, writing to new file
cat $backup_file | awk '{gsub(/ SIZE="0"/,"");print}' > $original_file

#echo finished
echo "Finished. Backup kept as $backup_file"